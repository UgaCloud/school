{% extends "../base.html" %}
{% load crispy_forms_tags %}
{% load humanize %}

{% block page_title %}Student Bill Details{% endblock %}

{% block content %}
<style>
    .profile_left {
        background: #f7f7f7;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    .profile_img {
        text-align: center;
        margin-bottom: 20px;
    }
    .profile_img img {
        border-radius: 50%;
        width: 120px;
        height: 120px;
        object-fit: cover;
    }
    .user_data li {
        margin-bottom: 10px;
    }
    .progress {
        height: 20px;
    }
    .btn-info {
        margin-top: 10px;
    }
    .table {
        margin-top: 20px;
    }
    .receipt {
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 8px;
        background: #fff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    .receipt h2, .receipt h3 {
        text-align: center;
        margin-bottom: 20px;
    }
    .receipt table {
        width: 100%;
        margin-bottom: 20px;
        border-collapse: collapse;
    }
    .receipt th, .receipt td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }
    .receipt th {
        background-color: #f2f2f2;
    }

    /* Gentellela theme progress bars - clean and professional */
    .progress {
        height: 20px;
        background: #f5f5f5;
        border-radius: 10px;
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
        overflow: hidden;
        margin-top: 6px;
    }

    .progress-bar {
        height: 100%;
        border-radius: 10px;
        transition: width 0.6s ease;
        position: relative;
    }

    .progress-bar.total {
        background: linear-gradient(90deg, #3498db, #2980b9);
    }

    .progress-bar.paid {
        background: linear-gradient(90deg, #27ae60, #2ecc71);
    }

    .progress-bar.balance {
        background: linear-gradient(90deg, #e74c3c, #c0392b);
    }

    /* Gentellela theme button colors */
    .btn-primary {
        background: linear-gradient(90deg, #3498db, #2980b9);
        border-color: #2980b9;
    }

    .btn-primary:hover {
        background: linear-gradient(90deg, #2980b9, #3498db);
        border-color: #3498db;
    }

    /* Receipt Styles */
    *{ box-sizing:border-box; }
    .receipt-wrapper{
      max-width:900px;
      margin:30px auto;
      background:#fff;
      border-radius:10px;
      padding:25px 35px;
      box-shadow:0 10px 25px rgba(0,0,0,.07);
    }

    .header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      border-bottom:2px solid #eaeaea;
      padding-bottom:15px;
    }

    .brand h2{
      margin:0;
      color:#1885b0;
      letter-spacing:1px;
    }
    .brand small{ color:#666; }

    .right-info{
      text-align:right;
      font-size:13px;
      color:#555;
    }

    .title{
      text-align:center;
      margin:25px 0 10px;
      font-weight:700;
      font-size:22px;
      letter-spacing:1px;
      color:#1c7798;
    }

    .invoice-to{
      margin:10px 0 15px;
      font-size:14px;
      line-height:1.4;
    }

    .receipt-wrapper table{
      width:100%;
      border-collapse:collapse;
      margin-top:15px;
      font-size:14px;
    }
    .receipt-wrapper thead{
      background:#0b7da2;
      color:#fff;
    }
    .receipt-wrapper th, .receipt-wrapper td{
      padding:10px 8px;
      border:1px solid #d7d7d7;
      text-align:left;
    }
    .receipt-wrapper th:nth-child(1), .receipt-wrapper td:nth-child(1){
      width:60px;
      text-align:center;
    }
    .receipt-wrapper td.amount{
      text-align:right;
    }

    .summary{
      margin-top:18px;
      width:320px;
      margin-left:auto;
      font-size:14px;
    }
    .summary div{
      display:flex;
      justify-content:space-between;
      padding:6px 0;
    }
    .summary .total{
      font-weight:700;
      font-size:16px;
      border-top:2px solid #ddd;
      margin-top:5px;
      padding-top:10px;
    }

    .notes{
      margin-top:15px;
      font-size:13px;
      color:#555;
    }

    .footer{
      margin-top:25px;
      font-size:12px;
      text-align:center;
      color:#777;
    }
</style>

<div class="x_content">
    <div class="row">
        <div class="col-md-3 col-sm-3 profile_left">
            <div class="profile_img">
                <img class="img-responsive img-fluid" src="{{ student_bill.student.photo.url }}" alt="Avatar">
            </div>
            <h3>{{ student_bill.student.student_name }}</h3>
            <ul class="list-unstyled user_data">
                <li><i class="fa fa-map-marker user-profile-icon"></i> {{ student_bill.student.reg_no }}</li>
                <li><i class="fa fa-briefcase user-profile-icon"></i> {{ student_bill.student.current_class.code }}</li>
            </ul>

            <h4>Bill Summary</h4>


<ul class="list-unstyled user_data">
  <li>
    <p>Total Amount - {{ student_bill.total_amount|intcomma }}/-</p>
    <div class="progress" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" aria-label="Total Amount Progress">
      <div class="progress-bar total" style="width: 100%;"></div>
    </div>
  </li>
  <li>
    <p>Amount Paid - {{ student_bill.amount_paid|intcomma }}/-</p>
    <div class="progress" role="progressbar" aria-valuenow="{{ amount_paid_percentage }}" aria-valuemin="0" aria-valuemax="100" aria-label="Amount Paid Progress">
      <div class="progress-bar paid" style="width: {{ amount_paid_percentage }}%;"></div>
    </div>
  </li>
  <li>
    <p>Balance - {{ balance|intcomma }}/-</p>
    <div class="progress" role="progressbar" aria-valuenow="{{ balance_percentage }}" aria-valuemin="0" aria-valuemax="100" aria-label="Balance Progress">
      <div class="progress-bar balance" style="width: {{ balance_percentage }}%;"></div>
    </div>
  </li>
</ul>


            <button class="btn btn-info btn-block" onclick="printReceipt()">Print Receipt</button>
        </div>

        <div class="col-md-9 col-sm-9">
            <div class="profile_title">
                <div class="col-md-6">
                    <h2>Billed Items</h2>
                </div>
                {% if active_role and active_role|lower == "bursar" or request.user.staff_account and request.user.staff_account.role.name|lower == "bursar" %}
                    <div class="col-md-6">
                        <div id="add-bill-item" class="pull-right" style="margin-top: 5px;">
                            <a class="btn btn-success" data-toggle="modal" data-target=".bill-item-modal-lg">
                                <i class="fa fa-plus"></i> Add Bill Item
                            </a>
                        </div>
                    </div>
                {% endif %}
            </div>

          <div class="table-scroll-wrapper">
                <table class="data table table-striped no-margin">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Item</th>
                            <th>Description</th>
                            <th class="hidden-phone">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in student_bill.items.all %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ item.bill_item }}</td>
                                <td>{{ item.description }}</td>
                                <td class="hidden-phone">{{ item.amount|intcomma }}/-</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div role="tabpanel">
                <ul class="nav nav-tabs bar_tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#tab_content1" role="tab" data-toggle="tab" aria-expanded="true">Payment History</a></li>
                    <li role="presentation"><a href="#tab_content2" role="tab" data-toggle="tab" aria-expanded="false">Credits</a></li>
                    <li role="presentation"><a href="#tab_content3" role="tab" data-toggle="tab" aria-expanded="false">Discounts</a></li>
                    <li role="presentation"><a href="#tab_content4" role="tab" data-toggle="tab" aria-expanded="false">Documents</a></li>
                </ul>
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="tab_content1" aria-labelledby="home-tab">
                        {% if active_role and active_role|lower == "bursar" or request.user.staff_account and request.user.staff_account.role.name|lower == "bursar" %}
                            <div class="mb-3">
                                <a class="btn btn-success" data-toggle="modal" data-target=".payment-modal-lg">
                                    <i class="fa fa-plus"></i> Record New Payment
                                </a>
                            </div>
                        {% endif %}
                        <div class="x_content">
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Date</th>
                                        <th>Payment Mode</th>
                                        <th>Reference No</th>
                                        <th>Amount</th>
                                        <th>Recorded By</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for payment in student_bill.payments.all %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td>{{ payment.payment_date|date:"M d, Y" }}</td>
                                            <td>{{ payment.payment_method }}</td>
                                            <td>{{ payment.reference_no }}</td>
                                            <td class="text-success"><strong>UGX {{ payment.amount|intcomma }}</strong></td>
                                            <td>{{ payment.recorded_by }}</td>
                                        </tr>
                                    {% empty %}
                                        <tr>
                                            <td colspan="6" class="text-center text-muted">
                                                <i class="fa fa-info-circle fa-2x"></i>
                                                <br>No payments recorded yet
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                                {% if student_bill.payments.all %}
                                <tfoot class="bg-light">
                                    <tr>
                                        <td colspan="4" class="font-weight-bold">TOTAL PAID</td>
                                        <td class="text-success font-weight-bold">UGX {{ student_bill.amount_paid|intcomma }}</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                                {% endif %}
                            </table>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content2" aria-labelledby="profile-tab">
                        <div class="x_content">
                            <div class="alert alert-info">
                                <i class="fa fa-info-circle"></i>
                                <strong>Credit System:</strong> Overpayments are automatically converted to credits for future bill payments.
                            </div>
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th>Credit Type</th>
                                        <th>Amount</th>
                                        <th>Description</th>
                                        <th>Date Created</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">
                                            <i class="fa fa-gift fa-2x"></i>
                                            <br>Credit system is active and monitoring payments
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content3" aria-labelledby="profile-tab">
                        <div class="x_content">
                            <div class="alert alert-warning">
                                <i class="fa fa-tags"></i>
                                <strong>Discount Information:</strong> Discount details and applied reductions will be displayed here.
                            </div>
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th>Discount Type</th>
                                        <th>Amount</th>
                                        <th>Description</th>
                                        <th>Applied Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">
                                            <i class="fa fa-tags fa-2x"></i>
                                            <br>No discounts applied yet
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content4" aria-labelledby="profile-tab">
                        <div class="x_content">
                            <div class="alert alert-secondary">
                                <i class="fa fa-file"></i>
                                <strong>Document Management:</strong> Student fees receipt  will be listed here.
                            </div>
                            {% if active_role and active_role|lower == "bursar" or request.user.staff_account and request.user.staff_account.role.name|lower == "bursar" %}
                            <div class="mb-3">
                                <a class="btn btn-primary" data-toggle="modal" data-target=".document-modal-lg">
                                    <i class="fa fa-plus"></i> Upload Document
                                </a>
                            </div>
                            {% endif %}
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th>Document Type</th>
                                        <th>File Name</th>
                                        <th>Upload Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for doc in bill_documents %}
                                    <tr>
                                        <td>{{ doc.get_document_type_display }}</td>
                                        <td>{{ doc.file.name|slice:":30" }}{% if doc.file.name|length > 30 %}...{% endif %}</td>
                                        <td>{{ doc.uploaded_at|date:"M d, Y" }}</td>
                                        <td><span class="badge badge-success">Active</span></td>
                                        <td>
                                            <a href="{{ doc.file.url }}" class="btn btn-sm btn-primary" target="_blank">View</a>
                                            {% if active_role and active_role|lower == "bursar" or request.user.staff_account and request.user.staff_account.role.name|lower == "bursar" %}
                                            <a href="{% url 'delete_bill_document' doc.id %}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this document?');">Delete</a>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">
                                            <i class="fa fa-file fa-2x"></i>
                                            <br>No documents uploaded yet
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Document Upload Modal -->
<div class="modal fade document-modal-lg no-print" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 12px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <div class="modal-header" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; border-radius: 12px 12px 0 0; border: none;">
                <h5 class="modal-title">
                    <i class="fa fa-cloud-upload"></i> Upload Document for {{ student_bill.student.student_name }}
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" style="opacity: 0.8;">
                    <span>&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'upload_bill_document' student_bill.id %}" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="modal-body" style="padding: 25px;">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>
                                    <i class="fa fa-tag text-primary"></i> Document Type *
                                </label>
                                <select class="form-control" name="document_type" required>
                                    <option value="">Select Document Type</option>
                                    {% for code, display in document_type_choices %}
                                    <option value="{{ code }}">{{ display }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>
                                    <i class="fa fa-file text-success"></i> Select File *
                                </label>
                                <input type="file" class="form-control" name="file" accept=".pdf,.doc,.docx,.jpg,.png,.jpeg" required>
                            </div>
                        </div>
                    </div>
                    <div class="alert alert-info">
                        <strong>Guidelines:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Max size: 3MB</li>
                            <li>Use clear file names</li>
                            <li>Ensure readability</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer" style="border: none; padding: 20px 25px;">
                    <button type="button" class="btn btn-secondary btn-modern" data-dismiss="modal">
                        <i class="fa fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn btn-info btn-modern">
                        <i class="fa fa-cloud-upload"></i> Upload
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Professional Modals -->
<div class="modal fade bill-item-modal-lg no-print" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 12px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 12px 12px 0 0; border: none;">
                <h5 class="modal-title">
                    <i class="fa fa-plus-circle"></i> Add New Bill Item
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" style="opacity: 0.8;">
                    <span>&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'add_student_bill_item' student_bill.id %}">
                {% csrf_token %}
                <div class="modal-body" style="padding: 25px;">
                    {{ bill_item_form|crispy }}
                </div>
                <div class="modal-footer" style="border: none; padding: 20px 25px;">
                    <button type="button" class="btn btn-secondary btn-modern" data-dismiss="modal">
                        <i class="fa fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn btn-primary btn-modern">
                        <i class="fa fa-save"></i> Add Bill Item
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade payment-modal-lg no-print" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 12px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <div class="modal-header" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border-radius: 12px 12px 0 0; border: none;">
                <h5 class="modal-title">
                    <i class="fa fa-credit-card"></i> Record New Payment
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" style="opacity: 0.8;">
                    <span>&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'record_payment' student_bill.id %}">
                {% csrf_token %}
                <div class="modal-body" style="padding: 25px;">
                    {{ payment_form|crispy }}
                </div>
                <div class="modal-footer" style="border: none; padding: 20px 25px;">
                    <button type="button" class="btn btn-secondary btn-modern" data-dismiss="modal">
                        <i class="fa fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn btn-success btn-modern">
                        <i class="fa fa-check"></i> Record Payment
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="printableReceipt" style="display:none;">
<div class="receipt-wrapper">
  <div class="header">
    <div class="brand">
      <h2>{{ school_settings.school_name|default:"SCHOOL NAME" }}</h2>
      <small>{{ school_settings.school_motto|default:"Tagline goes here" }}</small>
    </div>

    <div class="right-info">
      <div><strong>Receipt No:</strong> #{{ student_bill.id }}</div>
      <div><strong>Receipt Date:</strong> {% now "m/d/Y" %}</div>
    </div>
  </div>

  <h3 class="title">FEE RECEIPT</h3>

  <div class="invoice-to">
    <strong>Student Details:</strong><br>
    {{ student_bill.student.student_name }}<br>
    Reg No: {{ student_bill.student.reg_no }}<br>
    Class: {{ student_bill.student.current_class.code }}<br>
    Academic Year: {{ student_bill.academic_class.academic_year.academic_year }}
  </div>

  <table>
    <thead>
      <tr>
        <th>No.</th>
        <th>Fee Description</th>
        <th class="amount">Amount</th>
      </tr>
    </thead>
    <tbody>
      {% for item in student_bill.items.all %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ item.bill_item.item_name }} - {{ item.description }}</td>
        <td class="amount">UGX {{ item.amount|intcomma }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="summary">
    <div><span>Total Amount</span><span>UGX {{ student_bill.total_amount|intcomma }}</span></div>
    <div><span>Amount Paid</span><span>UGX {{ student_bill.amount_paid|intcomma }}</span></div>
    <div><span>Outstanding Balance</span><span>UGX {{ balance|intcomma }}</span></div>
    <div class="total"><span>Net Balance</span><span>UGX {{ balance|intcomma }}</span></div>
  </div>

  <div class="notes">
    <strong>Payment History:</strong><br>
    {% for payment in student_bill.payments.all %}
    - {{ payment.payment_date|date:"M d, Y" }}: UGX {{ payment.amount|intcomma }} via {{ payment.payment_method }} (Ref: {{ payment.reference_no }})<br>
    {% empty %}
    No payments recorded yet.<br>
    {% endfor %}
    <br>

    <strong>Terms & Conditions:</strong><br>
    This receipt is system generated and valid for fee payment confirmation.
  </div>

  <div class="footer">
    Thank you for your payment â€” keep this receipt for your records.
  </div>
</div>
</div>


<script>
// Professional Print Function
function printReceipt() {
    const receipt = document.getElementById("printableReceipt").innerHTML;
    const printWindow = window.open('', '_blank', 'height=800,width=1000,scrollbars=yes');

    printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
            <title>Fee Receipt - {{ student_bill.student.student_name }}</title>
            <meta charset="utf-8">
            <style>
                *{ box-sizing:border-box; }
                body{
                  font-family: Arial, Helvetica, sans-serif;
                  margin:0;
                  background:#f4f7fb;
                  padding: 20px;
                }

                .receipt-wrapper{
                  max-width:900px;
                  margin:0 auto;
                  background:#fff;
                  border-radius:10px;
                  padding:25px 35px;
                  box-shadow:0 10px 25px rgba(0,0,0,.07);
                }

                .header{
                  display:flex;
                  justify-content:space-between;
                  align-items:flex-start;
                  border-bottom:2px solid #eaeaea;
                  padding-bottom:15px;
                }

                .brand h2{
                  margin:0;
                  color:#1885b0;
                  letter-spacing:1px;
                }
                .brand small{ color:#666; }

                .right-info{
                  text-align:right;
                  font-size:13px;
                  color:#555;
                }

                .title{
                  text-align:center;
                  margin:25px 0 10px;
                  font-weight:700;
                  font-size:22px;
                  letter-spacing:1px;
                  color:#1c7798;
                }

                .invoice-to{
                  margin:10px 0 15px;
                  font-size:14px;
                  line-height:1.4;
                }

                table{
                  width:100%;
                  border-collapse:collapse;
                  margin-top:15px;
                  font-size:14px;
                }
                thead{
                  background:#0b7da2;
                  color:#fff;
                }
                th, td{
                  padding:10px 8px;
                  border:1px solid #d7d7d7;
                  text-align:left;
                }
                th:nth-child(1), td:nth-child(1){
                  width:60px;
                  text-align:center;
                }
                td.amount{
                  text-align:right;
                }

                .summary{
                  margin-top:18px;
                  width:320px;
                  margin-left:auto;
                  font-size:14px;
                }
                .summary div{
                  display:flex;
                  justify-content:space-between;
                  padding:6px 0;
                }
                .summary .total{
                  font-weight:700;
                  font-size:16px;
                  border-top:2px solid #ddd;
                  margin-top:5px;
                  padding-top:10px;
                }

                .notes{
                  margin-top:15px;
                  font-size:13px;
                  color:#555;
                }

                .footer{
                  margin-top:25px;
                  font-size:12px;
                  text-align:center;
                  color:#777;
                }

                @media print {
                    body { margin: 0; padding: 10px; }
                    .receipt-wrapper { box-shadow: none; }
                }
            </style>
        </head>
        <body>
    `);

    printWindow.document.write(receipt);
    printWindow.document.write(`
        </body>
        </html>
    `);

    printWindow.document.close();
    printWindow.focus();

    setTimeout(function() {
        printWindow.print();
        printWindow.close();
    }, 500);
}

// Basic modal focus
$(document).ready(function() {
    $('.modal').on('shown.bs.modal', function() {
        $(this).find('input:first').focus();
    });
});
</script>
{% endblock %}