{% extends 'base.html' %}
{% load custom_filters %}

{% block content %}
<div class="container mt-4">
    <h3>Your Teaching Timetable</h3>

    {% if timetable_data %}
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Day / Time</th>
                    {% for slot in time_slots %}
                        <th>{{ slot.start_time|time:"H:i" }} - {{ slot.end_time|time:"H:i" }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for weekday, day_label in weekdays %}
                    <tr>
                        <td>{{ day_label }}</td>
                        {% for slot in time_slots %}
                            <td>
                                {% with key=weekday|add:"_"|add:slot.id|stringformat:"s" %}
                                    {% with entry_list=timetable_data|get_item:key %}
                                        {% if entry_list %}
                                            {% for entry in entry_list %}
                                                <div>
                                                    <strong>{{ entry.subject.name }}</strong><br>
                                                    {{ entry.class_stream.name }}<br>
                                                    Room: {{ entry.classroom.name }}
                                                </div>
                                            {% endfor %}
                                        {% else %}
                                            <em>No class</em>
                                        {% endif %}
                                    {% endwith %}
                                {% endwith %}
                            </td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>You have no scheduled classes yet.</p>
    {% endif %}
</div>
{% endblock %}
