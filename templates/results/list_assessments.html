{% extends "../base.html" %}

{% block page_title %}Assessments - {{ academic_class }}{% endblock page_title %}

{% block content %}
<div class="row">
  <div class="col-md-12 col-sm-12 col-xs-12">
    <div class="x_panel">
      <div class="x_title">
        <h2>Assessments</h2>
        <ul class="nav navbar-right panel_toolbox">
          <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
        </ul>
        <div class="clearfix"></div>
      </div>

      <div class="x_content">
        <form method="get" class="form-horizontal form-label-left" action="">
          <div class="form-group">
            <label class="control-label col-md-2 col-sm-2" for="subject_id">Subject</label>
            <div class="col-md-3 col-sm-3">
              <select id="subject_id" name="subject_id" class="form-control">
                <option value="">All Subjects</option>
                {% for s in subjects %}
                  <option value="{{ s.id }}" {% if selected_subject_id == s.id|stringformat:"s" %}selected{% endif %}>{{ s.name }}</option>
                {% endfor %}
              </select>
            </div>

            <label class="control-label col-md-2 col-sm-2" for="assessment_type_id">Assessment Type</label>
            <div class="col-md-3 col-sm-3">
              <select id="assessment_type_id" name="assessment_type_id" class="form-control">
                <option value="">All Types</option>
                {% for at in assessment_types %}
                  <option value="{{ at.id }}" {% if selected_assessment_type_id == at.id|stringformat:"s" %}selected{% endif %}>{{ at.name }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="col-md-2 col-sm-2">
              <button type="submit" class="btn btn-primary btn-block">Filter</button>
            </div>
          </div>

          <div class="form-group">
            <label class="control-label col-md-2 col-sm-2" for="date_from">Date From</label>
            <div class="col-md-3 col-sm-3">
              <input type="date" id="date_from" name="date_from" value="{{ date_from }}" class="form-control" />
            </div>

            <label class="control-label col-md-2 col-sm-2" for="date_to">Date To</label>
            <div class="col-md-3 col-sm-3">
              <input type="date" id="date_to" name="date_to" value="{{ date_to }}" class="form-control" />
            </div>

            <div class="col-md-2 col-sm-2">
              <a href="?" class="btn btn-default btn-block">Reset</a>
            </div>
          </div>
        </form>

        <table id="datatable-checkbox" class="table table-striped table-bordered" style="width:100%">
          <thead>
            <tr>
              <th>#</th>
              <th>Assessment</th>
              <th>Subject</th>
              <th>Type</th>
              <th>Date</th>
              <th>Out Of</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
          {% for assessment in assessments %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td>{{ assessment }}</td>
              <td>{{ assessment.subject.name }}</td>
              <td>{{ assessment.assessment_type.name }}</td>
              <td>{{ assessment.date }}</td>
              <td>{{ assessment.out_of }}</td>
              <td>
                {% if can_add_results %}
                  <a href="{% url 'add_results' assessment.id %}" class="btn btn-primary btn-sm">Add Results</a>
                {% endif %}
                {% if user.is_superuser %}
                  <a href="{% url 'edit_assessment_page' assessment.id %}" class="btn btn-warning btn-sm"><i class="fa fa-edit"></i></a>
                  <a href="{% url 'delete_assessment' assessment.id %}" class="btn btn-danger btn-sm"><i class="fa fa-trash-o"></i></a>
                {% endif %}
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="7" class="text-center">No assessments found. Adjust filters above.</td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock content %}