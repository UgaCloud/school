<style>
    /* Student Information Section */
    .student-info-section {
        margin-top: 1cm;
        padding: 0.5cm;
        background: #ffffff;
        border: 1px solid #e0e6ed;
        border-radius: 4px;
        break-inside: avoid;
    }

    .student-info-header {
        display: inline-flex;
        align-items: center;
        padding: 0.3cm 0.8cm;
        font-size: 0.9rem;
        font-weight: 700;
        background: #1a3c5e;
        color: #fff;
        border-radius: 4px;
        text-transform: uppercase;
        margin-bottom: 0.5cm;
        cursor: pointer;
        transition: background 0.2s, transform 0.2s;
    }

    .student-info-header:hover {
        background: #2a4b7c;
        transform: scale(1.02);
    }

    .student-info-header i {
        margin-right: 0.3cm;
        transition: transform 0.3s;
    }

    .student-info-header.collapsed i {
        transform: rotate(-90deg);
    }

    .student-info-content {
        padding: 0.4cm;
        break-inside: avoid;
    }

    /* Print Button */
    .print-button {
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.2cm 0.5cm;
        background: #1a3c5e;
        color: #fff;
        border: none;
        border-radius: 4px;
        text-decoration: none;
        transition: background 0.2s;
    }

    .print-button:hover {
        background: #2a4b7c;
        color: #fff;
    }

    .print-button i {
        margin-right: 0.2cm;
    }

    /* Avatar */
    .student-avatar {
        width: 2.2cm;
        height: 2.2cm;
        border-radius: 50%;
        object-fit: cover;
        border: 1px solid #ffffff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .online-indicator {
        position: absolute;
        bottom: 0.1cm;
        right: 0.1cm;
        width: 0.4cm;
        height: 0.4cm;
        background: #28a745;
        border: 1px solid #fff;
        border-radius: 50%;
    }

    /* Student Details */
    .student-details {
        flex-grow: 1;
    }

    .student-name {
        font-size: 1.3rem;
        font-weight: 700;
        color: #1a3c5e;
        margin-bottom: 0.2cm;
        display: flex;
        align-items: center;
        gap: 0.3cm;
    }

    .class-badge {
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.2cm 0.5cm;
        background: #1a3c5e;
        color: #fff;
        border-radius: 4px;
    }

    .basic-info {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5cm;
        font-size: 0.8rem;
        color: #333;
        margin-bottom: 0.4cm;
    }

    .basic-info i {
        color: #1a3c5e;
        margin-right: 0.2cm;
    }

    .info-divider {
        border-top: 1px solid #e0e6ed;
        margin: 0.4cm 0;
    }

    .info-box-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.5cm;
    }

    .info-box {
        background: #f9fafb;
        padding: 0.4cm;
        border: 1px solid #e0e6ed;
        border-radius: 4px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .info-box ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .info-box li {
        display: flex;
        align-items: flex-start;
        gap: 0.3cm;
        margin-bottom: 0.3cm;
    }

    .info-box i {
        color: #1a3c5e;
        font-size: 0.9rem;
        margin-top: 0.1cm;
    }

    .info-box small {
        font-size: 0.7rem;
        color: #555;
    }

    .info-box strong {
        font-size: 0.8rem;
        font-weight: 600;
        color: #1a3c5e;
    }

    @media print {
        .student-info-section {
            border: none;
            background: #ffffff !important;
        }
        .student-info-header {
            cursor: default;
        }
        .student-info-header:hover {
            background: #1a3c5e;
            transform: none;
        }
        .student-info-header i {
            display: none;
        }
        .student-info-content {
            display: block !important;
        }
        .print-button {
            display: none;
        }
        .online-indicator {
            display: none;
        }
        .info-box {
            background: #ffffff !important;
            border: 1px solid #e0e6ed;
            box-shadow: none !important;
        }
    }

    @media screen and (max-width: 768px) {
        .student-info-section {
            margin-top: 0.5cm;
            padding: 0.3cm;
        }
        .student-info-header {
            font-size: 0.8rem;
            padding: 0.2cm 0.6cm;
        }
        .student-info-content {
            padding: 0.2cm;
        }
        .student-avatar {
            width: 1.8cm;
            height: 1.8cm;
        }
        .student-name {
            font-size: 1.1rem;
        }
        .class-badge {
            font-size: 0.65rem;
        }
        .basic-info {
            font-size: 0.7rem;
        }
        .info-box-container {
            grid-template-columns: 1fr;
        }
        .info-box {
            min-width: 100%;
        }
        .info-box i {
            font-size: 0.8rem;
        }
        .info-box small {
            font-size: 0.65rem;
        }
        .info-box strong {
            font-size: 0.7rem;
        }
    }
</style>

<section class="student-info-section" aria-labelledby="student-info-heading" role="region">
    <h3 class="student-info-header" id="student-info-heading" data-toggle="collapse" data-target="#student-info-content" aria-expanded="true" aria-controls="student-info-content">
        <i class="fas fa-chevron-down mr-2"></i>Student Information
    </h3>
    <div id="student-info-content" class="student-info-content collapse show" aria-labelledby="student-info-heading">
        <div class="d-flex justify-content-end mb-0.4cm">
            <!-- Quick access: Mini Report per Assessment Type -->
            <div class="btn-group mr-2">
                <button type="button" class="btn btn-outline-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    Mini Report
                </button>
                <div class="dropdown-menu dropdown-menu-right">
                    {% for at in assessment_types %}
                        <a
                          class="dropdown-item"
                          href="{% url 'student_mini_report' student.obj.id at.id %}{% if selected_term %}?term_id={{ selected_term }}{% endif %}">
                          {{ at.name }}
                        </a>
                    {% empty %}
                        <span class="dropdown-item text-muted">No assessment types</span>
                    {% endfor %}
                </div>
            </div>

            <!-- Existing: Full End-of-Term Report -->
            <a href="{% url 'student_term_report' student.obj.id %}{% if selected_term %}?term_id={{ selected_term }}{% endif %}" class="print-button" aria-label="Print Full Term Report">
                <i class="fas fa-print"></i> Print Report
            </a>
        </div>
        <div class="d-flex flex-column flex-md-row align-items-start gap-0.5cm">
            <!-- Avatar -->
            <div class="text-center text-md-start">
                <div class="position-relative">
                    <img src="{{ student.details.photo_url|default:'/static/images/default_student.png' }}" 
                         alt="{{ student.details.full_name|default:'Student Photo' }}" 
                         class="student-avatar" 
                         aria-label="Student Photo">
                    <span class="online-indicator"></span>
                </div>
            </div>
            <!-- Student Details -->
            <div class="student-details">
                <div class="student-name">
                    {{ student.details.full_name|default:"John Doe" }}
                    <span class="class-badge">{{ student.details.class_info|default:"S.2 Red" }}</span>
                </div>
                <div class="basic-info">
                    <div><i class="fas fa-id-card"></i>{{ student.details.registration_number|default:"N/A" }}</div>
                    <div><i class="fas fa-venus-mars"></i>{{ student.details.gender|default:"N/A" }}</div>
                </div>
                <hr class="info-divider">
                <div class="info-box-container">
                    <div class="info-box">
                        <ul>
                            <li>
                                <i class="fas fa-calendar-alt fa-lg"></i>
                                <div>
                                    <small>Academic Year</small><br>
                                    <strong>{{ student.details.academic_year|default:"2024/2025" }}</strong>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-globe fa-lg"></i>
                                <div>
                                    <small>Nationality</small><br>
                                    <strong>{{ student.details.nationality|default:"N/A" }}</strong>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-praying-hands fa-lg"></i>
                                <div>
                                    <small>Religion</small><br>
                                    <strong>{{ student.details.religion|default:"N/A" }}</strong>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="info-box">
                        <ul>
                            <li>
                                <i class="fas fa-user-shield fa-lg"></i>
                                <div>
                                    <small>Guardian</small><br>
                                    <strong>{{ student.details.guardian|default:"N/A" }} ({{ student.details.relationship|default:"N/A" }})</strong>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-phone fa-lg"></i>
                                <div>
                                    <small>Contact</small><br>
                                    <strong>{{ student.details.contact|default:"N/A" }}</strong>
                                </div>
                            </li>
                            <li>
                                <i class="fas fa-envelope fa-lg"></i>
                                <div>
                                    <small>Email</small><br>
                                    <strong>{{ student.details.email|default:"N/A" }}</strong>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>